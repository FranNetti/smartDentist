version: '3'

services:
  msg_broker:
    image: rabbitmq

  broker:
    build: .
    command: python3 app/smartDentistBroker/smartDentistBroker.py web
    volumes:
      - .:/code
    depends_on:
      - msg_broker

  forn1:
    build: .
    command: python3 app/smartDentistForno/smartDentistForno.py 10
    volumes:
      - .:/code
    depends_on:
      - msg_broker

  forn2:
    build: .
    command: python3 app/smartDentistForno/smartDentistForno.py 15
    volumes:
      - .:/code
    depends_on:
      - msg_broker

  forn3:
    build: .
    command: python3 app/smartDentistForno/smartDentistForno.py 25
    volumes:
      - .:/code
    depends_on:
      - msg_broker

  fornHTTP:
    image: nginx:latest
    ports:
      - "8080:80"
    volumes:
      - .:/code
      - ./site.conf:/etc/nginx/conf.d/default.conf
